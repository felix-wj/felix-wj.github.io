(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{519:function(a,e,s){"use strict";s.r(e);var t=s(10),r=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"启动命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动命令"}},[a._v("#")]),a._v(" 启动命令")]),a._v(" "),e("p",[a._v("以"),e("code",[a._v("nacos")]),a._v("为例，"),e("code",[a._v("nacos")]),a._v("官方的脚本文件提供的启动命令如下：")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" app.jar  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-server")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Xms2g")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Xmx2g")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Xmn1g")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:MetaspaceSize")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("128m "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:MaxMetaspaceSize")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("320m "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:-OmitStackTraceInFastThrow")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+HeapDumpOnOutOfMemoryError")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:HeapDumpPath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${BASE_DIR}")]),a._v("/logs/java_heapdump.hprof "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:-UseLargePages")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("JDK版本大于9：")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("-Xlog:gc*:file"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${BASE_DIR}")]),a._v("/logs/nacos_gc.log:time,tags:filecount"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(",filesize"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("100m\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("JDK版本小于等于9：")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+UseConcMarkSweepGC")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+UseCMSCompactAtFullCollection")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:CMSInitiatingOccupancyFraction")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("70")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+CMSParallelRemarkEnabled")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:SoftRefLRUPolicyMSPerMB")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+CMSClassUnloadingEnabled")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:SurvivorRatio")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v(" \n-Xloggc:"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${BASE_DIR}")]),a._v("/logs/nacos_gc.log "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-verbose:gc")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+PrintGCDetails")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+PrintGCDateStamps")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+PrintGCTimeStamps")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:+UseGCLogFileRotation")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:NumberOfGCLogFiles")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:GCLogFileSize")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v('100M"\n\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br")])]),e("h2",{attrs:{id:"参数说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[a._v("#")]),a._v(" 参数说明")]),a._v(" "),e("ul",[e("li",[e("p",[e("code",[a._v("-server")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("运行模式为"),e("code",[a._v("server")]),a._v("模式。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-Xms2g")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("初始堆内存大小为"),e("code",[a._v("2G")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-Xmx2g")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("最大堆内存大小为"),e("code",[a._v("2G")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-Xmn1g")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("新生代内存大小为"),e("code",[a._v("1G")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:MetaspaceSize=128m")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("元空间初始大小为"),e("code",[a._v("128M")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:MaxMetaspaceSize=320m")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("元空间最大大小为"),e("code",[a._v("320M")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:-OmitStackTraceInFastThrow")]),a._v("：禁用"),e("code",[a._v("JVM")]),a._v("在快速抛出异常时省略堆栈信息。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+HeapDumpOnOutOfMemoryError")]),a._v("：当"),e("code",[a._v("JVM")]),a._v("发生"),e("code",[a._v("OOM")]),a._v("时，生成堆转储文件。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:HeapDumpPath=${BASE_DIR}/logs/java_heapdump.hprof")]),a._v("：指定堆转储文件的路径。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:-UseLargePages")]),a._v("：禁用大页内存。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+UseConcMarkSweepGC")]),a._v("：指定"),e("code",[a._v("JVM")]),a._v("使用"),e("code",[a._v("CMS")]),a._v("垃圾收集器。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+UseCMSCompactAtFullCollection")]),a._v("：指定"),e("code",[a._v("CMS")]),a._v("在进行"),e("code",[a._v("Full GC")]),a._v("后进行内存碎片整理。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:CMSInitiatingOccupancyFraction=70")]),a._v("：指定"),e("code",[a._v("CMS")]),a._v("在老年代使用率达到"),e("code",[a._v("70%")]),a._v("时触发"),e("code",[a._v("CMS GC")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+CMSParallelRemarkEnabled")]),a._v("：在"),e("code",[a._v("CMS")]),a._v("的"),e("code",[a._v("remark")]),a._v("阶段并行标记。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:SoftRefLRUPolicyMSPerMB=0")]),a._v("：设置软引用的清理策略，0表示最大的敏感性，即一旦发生GC，所有软引用对象都会被清理掉。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+CMSClassUnloadingEnabled")]),a._v("：启用"),e("code",[a._v("CMS")]),a._v("类卸载。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:SurvivorRatio=8")]),a._v("：设置"),e("code",[a._v("Eden")]),a._v("区和"),e("code",[a._v("Survivor")]),a._v("区的比例为"),e("code",[a._v("8:1")]),a._v("。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-verbose:gc")]),a._v("：打印"),e("code",[a._v("GC")]),a._v("日志。")])])]),a._v(" "),e("p",[a._v("对于"),e("code",[a._v("JDK")]),a._v("版本大于等于"),e("code",[a._v("9")]),a._v("的"),e("code",[a._v("JVM")]),a._v("，"),e("code",[a._v("GC")]),a._v("日志参数：")]),a._v(" "),e("ul",[e("li",[e("p",[e("code",[a._v("-Xlog:gc*:file=${BASE_DIR}/logs/nacos_gc.log:time,tags:filecount=10,filesize=100m")])]),a._v(" "),e("ul",[e("li",[e("p",[e("code",[a._v("-Xlog:gc*")]),a._v("表示记录所有的垃圾收集活动。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("file=${BASE_DIR}/logs/nacos_gc.log")]),a._v(" 指定日志目录。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("time,tags")]),a._v("表示在每条日志消息中包含时间戳和标签。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("filecount=10,filesize=100m")]),a._v("表示日志文件的最大数量为10，每个日志文件的最大大小为100MB。当日志文件达到这个大小时，Java会关闭当前的日志文件，并打开一个新的日志文件。")])])])])]),a._v(" "),e("p",[a._v("对于"),e("code",[a._v("JDK")]),a._v("版本小于"),e("code",[a._v("9")]),a._v("的"),e("code",[a._v("JVM")]),a._v("，"),e("code",[a._v("GC")]),a._v("日志参数：")]),a._v(" "),e("ul",[e("li",[e("p",[e("code",[a._v("-Xloggc:${BASE_DIR}/logs/nacos_gc.log")]),a._v("：指定"),e("code",[a._v("GC")]),a._v("日志文件的路径。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+PrintGCDetails")]),a._v("：打印"),e("code",[a._v("GC")]),a._v("的详细信息。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+PrintGCDateStamps")]),a._v("：打印"),e("code",[a._v("GC")]),a._v("的时间戳。")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-XX:+UseGCLogFileRotation")]),a._v("：启用"),e("code",[a._v("GC")]),a._v("日志文件的轮转。")])])]),a._v(" "),e("p",[a._v("在设置gc日志参数的时候需要注意：")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("日志路径需要是已存在的，否则无法生成日志文件。")])]),a._v(" "),e("li",[e("p",[a._v("使用Xlogc设置gc日志需要动态生成日志文件名，否则程序重启会覆盖之前的日志文件。即设置成"),e("code",[a._v("-Xloggc:${BASE_DIR}/logs/nacos_gc$(date +%Y%m%d%H%M%S).log")])])])]),a._v(" "),e("h2",{attrs:{id:"指定配置文件参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#指定配置文件参数"}},[a._v("#")]),a._v(" 指定配置文件参数")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--spring.profiles.active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("local\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 或者")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dspring.profiles.active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("local\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("h2",{attrs:{id:"gc日志参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gc日志参数"}},[a._v("#")]),a._v(" GC日志参数")]),a._v(" "),e("h2",{attrs:{id:"脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#脚本"}},[a._v("#")]),a._v(" 脚本")]),a._v(" "),e("h3",{attrs:{id:"启动脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动脚本"}},[a._v("#")]),a._v(" 启动脚本")]),a._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token shebang important"}},[a._v("#!/bin/bash")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("JAR_FILE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$1")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("JAVA_OPTS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-Xms64m -Xmx256m -Xss1m  -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/path/to/dump"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在新的终端中启动 并且设置终端标题")]),a._v("\nstart "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"echo -ne '"),e("span",{pre:!0,attrs:{class:"token entity",title:"\\033"}},[a._v("\\033")]),a._v("]0;"),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${JAR_FILE}")]),e("span",{pre:!0,attrs:{class:"token entity",title:"\\007"}},[a._v("\\007")]),a._v("'; java -jar  "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${JAVA_OPTS}")]),a._v(" -Dspring.profiles.active=local "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${JAR_FILE}")]),a._v(' exec bash"')]),a._v("\n\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);